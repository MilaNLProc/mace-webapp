language: generic
sudo: required

services:
    - docker

before_install:
    - docker build -t rstats-data-mvp:latest .

# script:
#     - docker build --target test --progress=plain -t rstats-data-mvp:latest

# after_success:
#     - docker build --target test --progress=plain -t rstats-data-mvp:test .


    # dist: trusty   # Use Ubuntu 14.04 image (instead of 12.04)
    # language: r
    # # sudo: false
    # r: 4.0.2
    
    # # Install packrat if needed and have it restore packages.
    # install:
    #     - R -e 'if (system.file(package="packrat") == "") install.packages("packrat")'
    #     - R -e "packrat::packify(); packrat::restore()"
    
    # cache:
    #   # Main R library
    #   packages: true
    #   directories:
    #     # Packrat packages
    #     - packrat/lib
    #     # PhantomJS
    #     - travis_phantomjs
    
    # # Install PhantomJS (if not cached)
    # before_install:
    #     - echo "options(repos = c(CRAN = 'https://packagemanager.rstudio.com/all/__linux__/xenial/latest'))" >> ~/.Rprofile.site
    #     - echo "options(HTTPUserAgent = paste0('R/', getRversion(), ' R (',
    #          paste(getRversion(), R.version['platform'], R.version['arch'], R.version['os']),
    #          ')'))" >> ~/.Rprofile.site
    
    
    #     - "export PHANTOMJS_VERSION=2.1.1"
    #     - "phantomjs --version"
    #     - "export PATH=$PWD/travis_phantomjs/phantomjs-$PHANTOMJS_VERSION-linux-x86_64/bin:$PATH"
    #     - "hash -r"
    #     - "phantomjs --version"
    #     - "if [ $(phantomjs --version) != $PHANTOMJS_VERSION ]; then rm -rf $PWD/travis_phantomjs; mkdir -p $PWD/travis_phantomjs; fi"
    #     - "if [ $(phantomjs --version) != $PHANTOMJS_VERSION ]; then wget https://github.com/Medium/phantomjs/releases/download/v$PHANTOMJS_VERSION/phantomjs-$PHANTOMJS_VERSION-linux-x86_64.tar.bz2 -O $PWD/travis_phantomjs/phantomjs-$PHANTOMJS_VERSION-linux-x86_64.tar.bz2; fi"
    #     - "if [ $(phantomjs --version) != $PHANTOMJS_VERSION ]; then tar -xvf $PWD/travis_phantomjs/phantomjs-$PHANTOMJS_VERSION-linux-x86_64.tar.bz2 -C $PWD/travis_phantomjs; fi"
    #     - "if [ $(phantomjs --version) != $PHANTOMJS_VERSION ]; then hash -r; fi"
    #     - "phantomjs --version"
    
    # script:
    #     - R -f run_tests.R
    